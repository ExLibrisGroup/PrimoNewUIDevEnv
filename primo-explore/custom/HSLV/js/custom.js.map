{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/HSLV/js/main.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","app","angular","constant","config","$sceDelegateProvider","nodeserver","urlWhitelist","resourceUrlWhitelist","push","controller","console","log","this","component","bindings","parentCtrl","template","vm","getSearchTerm","term","$scope","$http","book_icon","result","pnx","addata","doi","display","type","articleURL","jsonp","jsonpCallbackParam","then","response","article","data","error","issn","replace","journalURL","journal","newThumbnail","item","browzineEnabled","coverImageUrl","$doCheck","changes","selectedThumbnailLink","linkURL","query","facetService","$location","$$search","split","angularLoad","showTabsAndScopes","prmActionCtrl","$onInit","actionExists","smsAction","addAction","$onDestroy","removeAction","factory","addActionIcon","actionListService","requiredActionsList","splice","index","name","actionsToIndex","onToggle","actionsToDisplay","unshift","removeActionIcon","indexOf","actionLabelNamesMap","label","actionIconNamesMap","actionIcons","icon","hasOwnProperty","finishedSmsEvent","$watch","sendEmailService","carriers","smsCarriers","carrier","phoneNumber","telRegEx","validate","test","isCaptcha","window","appConfig","getCaptchaPublicKey","setResponse","gCaptchaResponse","sendSms","sendEmail","catch","finally","run","put","value","iconSet","ATT","T-Mobile","Virgin","Sprint","Nextel","Verizon","Cricket","Qwest","Project Fi","hathiTrustBaseUrl","$q","svc","findFullViewRecord","ids","deferred","defer","hathiTrustLookupUrl","join","cache","resp","fullTextUrl","j","items","usRightsString","toLowerCase","records","fromRecord","recordURL","resolve","promise","hathiTrust","hathiTrustIconPath","self","setDefaults","isOnline","hideOnline","updateHathiTrustAvailability","msg","prmSearchResultAvailabilityLine","delivery","GetIt1","some","g","links","l","isLinktoOnline","hathiTrustIds","oclcid","map","id","res","fullTextLink"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","var app = app || angular.module(\n  'viewCustom', ['angularLoad', 'hathiTrustAvailability', 'sendSms']\n).constant(\n  'nodeserver', \"https://apiconnector.thirdiron.com/v1/libraries/72\"\n).config([\n  '$sceDelegateProvider',\n  'nodeserver',\n  function ($sceDelegateProvider, nodeserver) {\n    var urlWhitelist = $sceDelegateProvider.resourceUrlWhitelist();\n    urlWhitelist.push(nodeserver + '**');\n    $sceDelegateProvider.resourceUrlWhitelist(urlWhitelist);\n  }\n]);\n\napp.controller('prmFullViewServiceContainerAfterController', [function () {\n  var vm = this;\n  console.log(this);\n  console.log('OK');\n}]);\n\napp.component('prmFullViewServiceContainerAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmFullViewServiceContainerAfterController',\n  template: '<getit-to-link-resolver-full></getit-to-link-resolver-full>'\n});\n\n// Enhance No Results tile\n\napp.controller('prmNoSearchResultAfterController', [function () {\n  var vm = this;\n  vm.getSearchTerm = getSearchTerm;\n  function getSearchTerm() {\n    return vm.parentCtrl.term;\n  }\n}]);\n\napp.component('prmNoSearchResultAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmNoSearchResultAfterController',\n  template: '<md-card class=\"default-card zero-margin _md md-primoExplore-theme\"><md-card-title><md-card-title-text><span translate=\"\" class=\"md-headline ng-scope\">No records found.</span></md-card-title-text></md-card-title><md-card-content><p><span>There are no results matching your search: <i>{{$ctrl.getSearchTerm()}}</i>. Looking for a book? Try again searching items held at other libraries:</span></p><md-button class=\"md-raised md-button md-primoExplore-theme md-ink-ripple\" href=\"http://www.worldcat.org/search?q={{$ctrl.getSearchTerm()}}\" type=\"button\" aria-label=\"Search WorldCat\" style=\"margin-left:0;margin-right:0;\"> <img src=\"custom/NULV3/img/worldcat-logo.png\" width=\"22\" height=\"22\" alt=\"worldcat-logo\" style=\"vertical-align:middle;\"> Search WorldCat</md-button><p><span>Looking for an article? Try <strong><a href=\"http://scholar.google.com/scholar?hl=en&q={{$ctrl.getSearchTerm()}}\">Google Scholar</a></strong></span>.</p><p><span translate=\"\" class=\"bold-text ng-scope\">Suggestions:</span></p><ul><li translate=\"\" class=\"ng-scope\">Make sure that all words are spelled correctly.</li><li translate=\"\" class=\"ng-scope\">Try a different search scope.</li><li translate=\"\" class=\"ng-scope\">Try different search terms.</li><li translate=\"\" class=\"ng-scope\">Try more general search terms.</li><li translate=\"\" class=\"ng-scope\">Try fewer search terms.</li></ul><p><strong><a href=\"http://www.library.northwestern.edu/research/ask-us/index.html\">Contact a Research Librarian for Assistance</a></strong>.</p></md-card-content></md-card>'\n});\n\n//Add Interlibrary Loan links to My Account\n\napp.component('prmLoansOverviewAfter', {\n  bindings: {},\n  template: '<div class=\"tiles-grid-tile\"><div class=\"tile-content layout-column\" layout=\"column\"><div class=\"tile-header layout-column\" layout=\"column\"><div class=\"layout-align-space-between-stretch layout-row\" layout-align=\"space-between\"><h2 class=\"header-link light-text\"><span>Interlibrary Loan</span></h2></div></div><md-button class=\"button-with-icon overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view interlibrary loans checked out\" style=\"\" href=\"https://northwestern.illiad.oclc.org/illiad/illiad.dll?Action=10&Form=66\"><span>View Items Checked Out</span></md-button><md-button class=\"button-with-icon overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view interlibrary loans checked out\" style=\"\" href=\"https://northwestern.illiad.oclc.org/illiad/illiad.dll?Action=10&Form=64\"><span>View Items Available</span></md-button><md-button class=\"button-with-icon  overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view interlibrary loans checked out\" style=\"\" href=\"https://northwestern.illiad.oclc.org/illiad/illiad.dll?Action=10&Form=62\"><span>View Requests in Process</span></md-button></div></div>'\n});\n\n//End add ILL links\n\n// Check for content in Browzine\n\napp.controller('prmSearchResultAvailabilityLineAfterController', function ($scope, $http, nodeserver) {\n  var vm = this;\n  $scope.book_icon = \"https://s3.amazonaws.com/thirdiron-assets/images/integrations/browzine_open_book_icon.png\";\n  if (vm.parentCtrl.result.pnx.addata.doi && vm.parentCtrl.result.pnx.display.type[0] == 'article') {\n    vm.doi = vm.parentCtrl.result.pnx.addata.doi[0] || '';\n    var articleURL = nodeserver + \"/articles?DOI=\" + vm.doi;\n    $http.jsonp(articleURL, { jsonpCallbackParam: 'callback' }).then(function (response) {\n      $scope.article = response.data;\n    }, function (error) {\n      console.log(error);\n    });\n  }\n  if (vm.parentCtrl.result.pnx.addata.issn && vm.parentCtrl.result.pnx.display.type[0] == 'journal') {\n    vm.issn = vm.parentCtrl.result.pnx.addata.issn[0].replace(\"-\", \"\") || '';\n    var journalURL = nodeserver + \"/journals?ISSN=\" + vm.issn;\n    $http.jsonp(journalURL, { jsonpCallbackParam: 'callback' }).then(function (response) {\n      $scope.journal = response.data;\n    }, function (error) {\n      console.log(error);\n    });\n  }\n});\n\n//Add Browzine and Hathitrust links to Brief Results\n\napp.component('prmSearchResultAvailabilityLineAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmSearchResultAvailabilityLineAfterController',\n  template: '<div ng-if=\"article.data.browzineWebLink\"><a href=\"{{ article.data.browzineWebLink }}\" target=\"_blank\" title=\"Via BrowZine\"><img src=\"https://s3.amazonaws.com/thirdiron-assets/images/integrations/browzine_open_book_icon.png\" class=\"browzine-icon\"> View Issue Contents <md-icon md-svg-icon=\"primo-ui:open-in-new\" aria-label=\"icon-open-in-new\" role=\"img\" class=\"browzine-external-link\"><svg id=\"open-in-new_cache29\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"504\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"></svg></md-icon></a></div><div ng-if=\"journal.data[0].browzineWebLink\"><a href=\"{{ journal.data[0].browzineWebLink }}\" target=\"_blank\" title=\"Via BrowZine\"><img src=\"https://s3.amazonaws.com/thirdiron-assets/images/integrations/browzine_open_book_icon.png\" class=\"browzine-icon\"> View Journal Contents <md-icon md-svg-icon=\"primo-ui:open-in-new\" aria-label=\"icon-open-in-new\" role=\"img\" class=\"browzine-external-link\"><svg id=\"open-in-new_cache29\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"504\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"></svg></md-icon></a></div><hathi-trust-availability hide-online=\"true\"></hathi-trust-availability>'\n});\n\n// Add Journal Cover Images from BrowZine\n\napp.controller('prmSearchResultThumbnailContainerAfterController', function ($scope, $http, nodeserver) {\n  var vm = this;\n  var newThumbnail = '';\n  // checking for item property as this seems to impact virtual shelf browse (for reasons as yet unknown)\n  if (vm.parentCtrl.item && vm.parentCtrl.item.pnx.addata.issn) {\n    vm.issn = vm.parentCtrl.item.pnx.addata.issn[0].replace(\"-\", \"\") || '';\n    var journalURL = nodeserver + \"/journals?ISSN=\" + vm.issn;\n    $http.jsonp(journalURL, { jsonpCallbackParam: 'callback' }).then(function (response) {\n      if (response.data.data[\"0\"] && response.data.data[\"0\"].browzineEnabled) {\n        newThumbnail = response.data.data[\"0\"].coverImageUrl;\n      }\n    }, function (error) {\n      console.log(error); //\n    });\n  }\n  vm.$doCheck = function (changes) {\n    if (vm.parentCtrl.selectedThumbnailLink) {\n      if (newThumbnail != '') {\n        vm.parentCtrl.selectedThumbnailLink.linkURL = newThumbnail;\n      }\n    }\n  };\n});\n\napp.component('prmSearchResultThumbnailContainerAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmSearchResultThumbnailContainerAfterController'\n});\n\n// End BrowZine - Primo Integration\n\n//Logo with link\n\n/*\napp.controller('prmLogoAfterController', [function () {\n  var ctrl = this;\n\n  ctrl.getIconLink = function () {\n    return ctrl.parentCtrl.iconLink;\n  };\n}]);\n\napp.component('prmLogoAfter', {\n  bindings: {\n    parentCtrl: '<'\n  },\n  controller: 'prmLogoAfterController',\n  template: ' \\n    <div class=\"product-logo product-logo-local\" layout=\"row\" layout-align=\"start center\" layout-fill id=\"banner\" tabindex=\"0\" role=\"banner\"><a href=\"http://www.library.northwestern.edu/\"><img ng-src=\"{{$ctrl.getIconLink()}}\" alt=\"{{(\\'nui.header.LogoAlt\\' | translate)}}\"/></a>\\n    </div>\\n  '\n});\n*/\n\n//End add logo with link\n\n\n//Add NUPrint link to account\n\napp.component('prmMessagesAndBlocksOverviewAfter', {\n  bindings: { parentCtrl: '<' },\n  template: '<div class=\"tiles-grid-tile\"><div class=\"tile-content layout-column\" layout=\"column\"><div class=\"tile-header layout-column\" layout=\"column\"><div class=\"layout-align-space-between-stretch layout-row\" layout=\"row\" layout-align=\"space-between\"><h2 class=\"header-link light-text\"><span>NUPrint</span></h2></div></div><md-button class=\"button-with-icon overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view nuprint account\" style=\"\" href=\"https://nuprint.northwestern.edu/\"><span>View Account</span></md-button></div></div>'\n});\n\n//End Add NUPrint\n//Other search options\n\napp.controller('prmFacetRangeAfterController', [function () {\n  try {\n    this.query = this.parentCtrl.facetService.$location.$$search.query.split(\",\")[2];\n  } catch (e) {\n    this.query = \"\";\n  }\n}]);\n\napp.component('prmFacetRangeAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmFacetRangeAfterController',\n  template: '<md-card class=\"default-card zero-margin _md md-primoExplore-theme\"><md-card-content><p><strong>Not finding the book you were looking for?</strong> Try searching items held at other libraries:</p><md-button class=\"md-raised md-button md-primoExplore-theme md-ink-ripple\" href=\"http://www.worldcat.org/search?q={{$ctrl.query}}\" type=\"button\" aria-label=\"Search WorldCat\" style=\"margin-left:0;margin-right:0;\"> <img src=\"custom/NULV3/img/worldcat-logo.png\" width=\"22\" height=\"22\" alt=\"worldcat-logo\" style=\"vertical-align:middle;\"> Search WorldCat</md-button><p><span>Looking for an article? Try <strong><a href=\"http://scholar.google.com/scholar?hl=en&q={{$ctrl.query}}\">Google Scholar</a></strong></span>.</p>Looking for related concepts? Try <strong><a href=\"http://turing.library.northwestern.edu/login?url=https://yewno.com/edu/?query={{$ctrl.query}}\"\">Yewno</a></strong>.<p></p><p>Other questions? <strong><a href=\"http://www.library.northwestern.edu/research/ask-us/index.html\">Contact a Research Librarian for Assistance</a></strong>.</p></md-card-content></md-card>'\n});\n\n//Always display scope dropdown for basic searches\n\napp.component('prmSearchBarAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'SearchBarAfterController'\n});\n\napp.controller('SearchBarAfterController', ['angularLoad', function (angularLoad) {\n  var vm = this;\n  vm.parentCtrl.showTabsAndScopes = true;\n}]);\n\n//End display scopes\n\n//Add SMS actions menu\n\n'use strict';\n\nangular.module(\"sendSms\", [\"ngMaterial\", \"primo-explore.components\"]), angular.module(\"sendSms\").component(\"addSmsAction\", {\n  require: { prmActionCtrl: \"^prmActionList\" },\n  controller: [\"customActions\", \"smsOptions\", function (e, n) {\n    var t = this;\n    this.$onInit = function () {\n      e.actionExists(n.smsAction, t.prmActionCtrl) || e.addAction(n.smsAction, t.prmActionCtrl);\n    }, this.$onDestroy = function () {\n      e.actionExists(n.smsAction, t.prmActionCtrl) && e.removeAction(n.smsAction, t.prmActionCtrl);\n    };\n  }]\n}), angular.module(\"sendSms\").factory(\"customActions\", function () {\n  return {\n    addAction: function addAction(e, n) {\n      this.actionExists(e, n) ? console.error(\"Action already exists: \", e) : (this.addActionIcon(e, n), n.actionListService.requiredActionsList.splice(e.index, 0, e.name), n.actionListService.actionsToIndex[e.name] = e.index, n.actionListService.onToggle[e.name] = e.onToggle, n.actionListService.actionsToDisplay.unshift(e.name));\n    },\n    removeAction: function removeAction(e, n) {\n      if (this.actionExists(e, n)) {\n        this.removeActionIcon(e, n), delete n.actionListService.actionsToIndex[e.name], delete n.actionListService.onToggle[e.name];\n        var t = n.actionListService.actionsToDisplay.indexOf(e.name);\n        n.actionListService.actionsToDisplay.splice(t, 1), t = n.actionListService.requiredActionsList.indexOf(e.name), n.actionListService.requiredActionsList.splice(t, 1);\n      } else console.error(\"Action does not exist: \", e);\n    },\n    addActionIcon: function addActionIcon(e, n) {\n      n.actionLabelNamesMap[e.name] = e.label, n.actionIconNamesMap[e.name] = e.name, n.actionIcons[e.name] = e.icon;\n    },\n    removeActionIcon: function removeActionIcon(e, n) {\n      delete n.actionLabelNamesMap[e.name], delete n.actionIconNamesMap[e.name], delete n.actionIcons[e.name];\n    },\n    actionExists: function actionExists(e, n) {\n      return n.actionListService.actionsToIndex.hasOwnProperty(e.name);\n    }\n  };\n}), angular.module(\"sendSms\").component(\"ocaSendSms\", {\n  bindings: { item: \"<\", finishedSmsEvent: \"&\" },\n  template: '<div class=\"send-actions-content-item\" layout=\"row\"><md-content layout-wrap layout-padding layout-fill><form name=\"smsForm\" novalidate layout=\"column\" layout-align=\"center center\" (submit)=\"$ctrl.sendSms($event);\"><div layout=\"row\" class=\"layout-full-width\" layout-align=\"center center\"><div flex=\"20\" flex-sm=\"10\" hide-xs></div><div class=\"form-focus service-form\" layout-padding flex><div layout-margin><div layout=\"column\"><h4 class=\"md-subhead\">Standard message and data rates may apply.</h4><md-input-container class=\"underlined-input md-required\"><label>Phone number:</label><input ng-model=\"$ctrl.phoneNumber\" name=\"phoneNumber\" type=\"text\" required ng-pattern=\"::$ctrl.telRegEx\"><div ng-messages=\"smsForm.phoneNumber.$error\"><div ng-message=\"pattern, required \">phone number is invalid</div></div></md-input-container><md-input-container class=\"md-required\"><label>Carrier:</label><md-select ng-model=\"$ctrl.carrier\" name=\"carrier\" placeholder=\"Select a carrier\" required><md-option ng-repeat=\"(carrier, address) in carriers\" value=\"{{ address }}\">{{ carrier }}</md-option></md-select><div ng-messages=\"smsForm.carrier.$error\"><div ng-message=\"required\">please select a carrier</div></div></md-input-container><md-input-container class=\"underlined-input\" ng-if=\"$ctrl.isCaptcha\"><div vc-recaptcha key=\"$ctrl.getCaptchaPublicKey()\"on-success=\"$ctrl.setResponse(response)\"></div><span class=\"recaptcha-error-info\" ng-show=\"smsForm.$submitted && (smsForm.recaptchaResponse.$invalid || smsForm.$error.recaptcha.length)\"><span translate=\"captcha.notselected\"></span></span></md-input-container></div></div></div><div flex=\"20\" flex-sm=\"10\" hide-xs></div>\\n</div>\\n<div layout=\"row\"><div layout=\"row\" layout-align=\"center\" layout-fill><md-button type=\"submit\" class=\"button-with-icon button-large button-confirm\" aria-label=\"Send the result by SMS\"><prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"send\"></prm-icon><span translate=\"email.popup.link.send\"></span></md-button></div></div></form></md-content></div><prm-send-email ng-hide=\"true\"></prm-send-email><oca-send-sms-after parent-ctrl=\"$ctrl\"></oca-send-sms-after>',\n  controller: [\"$scope\", \"smsOptions\", function (e, n) {\n    var t = this;\n    this.$onInit = function () {\n      e.$watch(\"$$childTail.$ctrl\", function (e) {\n        return t.sendEmailService = e.sendEmailService;\n      }), e.carriers = n.smsCarriers, t.carrier = t.phoneNumber = \"\", t.telRegEx = /^\\d{3}( |-)?\\d{3}( |-)?\\d{4}$/;\n    }, this.validate = function () {\n      return t.telRegEx.test(t.phoneNumber) && t.carrier;\n    }, this.isCaptcha = function () {\n      return \"Y\" == window.appConfig[\"system-configuration\"][\"Activate Captcha [Y/N]\"];\n    }, this.getCaptchaPublicKey = function () {\n      return window.appConfig[\"system-configuration\"][\"Public Captcha Key\"];\n    }, this.setResponse = function (e) {\n      return t.gCaptchaResponse = e;\n    }, this.sendSms = function () {\n      t.validate() && t.sendEmailService.sendEmail([t.phoneNumber + \"@\" + t.carrier], \"\", \"\", [t.item], t.gCaptchaResponse).then(function (e) {\n        return console.log(\"sms successfully sent\", e);\n      }).catch(function (e) {\n        return console.error(\"sms sending failed\", e);\n      }).finally(function () {\n        return t.finishedSmsEvent();\n      });\n    };\n  }]\n}).run([\"$templateCache\", \"smsOptions\", function (e, n) {\n  e.put(\"components/search/actions/actionContainer/action-container.html\", \"\\n  <oca-send-sms ng-if=\\\"($ctrl.actionName==='\" + n.smsAction.name + '\\')\" finished-sms-event=\"$ctrl.throwCloseTabsEvent()\" item=\"::$ctrl.item\"></oca-send-sms>\\n  <prm-send-email ng-if=\"($ctrl.actionName===\\'E-mail\\')\" (finished-email-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [toggleform]=\"::$ctrl.toggleActionCotent\" [user]=\"::\\'\\'\"></prm-send-email>\\n  <prm-citation ng-if=\"($ctrl.actionName===\\'Citation\\')\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-citation>\\n  <prm-permalink ng-if=\"($ctrl.actionName===\\'Permalink\\')\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-permalink>\\n  <prm-print-item ng-if=\"($ctrl.actionName===\\'Print\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-print-item>\\n  <prm-endnote ng-if=\"($ctrl.actionName===\\'EndNote\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-endnote>\\n  <prm-easybib ng-if=\"($ctrl.actionName===\\'EasyBib\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-easybib>\\n  <prm-refworks ng-if=\"($ctrl.actionName===\\'RefWorks\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-refworks>\\n  <prm-export-ris ng-if=\"($ctrl.actionName===\\'RISPushTo\\')\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-export-ris>\\n  <prm-action-container-after parent-ctrl=\"$ctrl\"></prm-action-container-after>');\n}]), angular.module(\"sendSms\").value(\"smsOptions\", { smsAction: { name: \"send_sms\", label: \"SMS\", index: 9, icon: { icon: \"ic_smartphone_24px\", iconSet: \"hardware\", type: \"svg\" } }, smsCarriers: { ATT: \"txt.att.net\", \"T-Mobile\": \"tmomail.net\", Virgin: \"vmobl.com\", Sprint: \"messaging.sprintpcs.com\", Nextel: \"messaging.nextel.com\", Verizon: \"vtext.com\", Cricket: \"mms.mycricket.com\", Qwest: \"qwestmp.com\", \"Project Fi\": \"msg.fi.google.com\" } });\n\napp.component('prmActionListAfter', {\n  template: '<add-sms-action />'\n});\n\n//end SMS \n\n//Adds link to Yewno after each set of ten results\n\napp.controller('prmSearchResultListAfterController', [function () {\n  try {\n    this.query = this.parentCtrl.facetService.$location.$$search.query.split(\",\")[2];\n  } catch (e) {\n    this.query = \"\";\n  }\n}]);\n\napp.component('prmSearchResultListAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmSearchResultListAfterController',\n  template: '<div class=\"layout-sm-column layout=\"column\"><div class=\"layout-row\" layout=\"row\"><div class=\"layout-row flex\" layout=\"row\"><md-card class=\"one-slot _md md-primoExplore-theme flex yewno-recommender\"><md-card-content class=\"layout-row\" layout=\"row\"><div class=\"max-width-100\"><div class=\"layout-row\"><div class=\"resource-image\"><div class=\"resource-image-inner normlized-resource-image\"><img class=\"md-card-image\" src=\"custom/NULV3/img/yewno-logo.png\"></div></div><div class=\"resource-content layout-fill\"><h3 class=\"normal-text resource-title\"><a href=\"http://turing.library.northwestern.edu/login?url=https://yewno.com/edu/?query={{$ctrl.query}}\">Try Yewno Discover</a></h3><p>Yewno is a new research platform that displays search results as relationships between concepts.</p><p>Search Yewno when you want to explore a topic and see what the connections are.</p><div></div></div></div></md-card-content></md-card></div></div></div>'\n});\n\n//End add link to Yewno\n//HathiTrust availability link\n\nangular.module('hathiTrustAvailability', []).value('hathiTrustIconPath', 'custom/NULV3/img/hathitrust.svg').constant('hathiTrustBaseUrl', \"https://catalog.hathitrust.org/api/volumes/brief/json/\").config(['$sceDelegateProvider', 'hathiTrustBaseUrl', function ($sceDelegateProvider, hathiTrustBaseUrl) {\n  var urlWhitelist = $sceDelegateProvider.resourceUrlWhitelist();\n  urlWhitelist.push(hathiTrustBaseUrl + '**');\n  $sceDelegateProvider.resourceUrlWhitelist(urlWhitelist);\n}]).factory('hathiTrust', ['$http', '$q', function ($http, $q) {\n  var svc = {};\n  var hathiTrustBaseUrl = \"https://catalog.hathitrust.org/api/volumes/brief/json/\";\n\n  svc.findFullViewRecord = function (ids) {\n    var deferred = $q.defer();\n\n    var handleResponse = function handleResponse(resp) {\n      var data = resp.data;\n      var fullTextUrl = null;\n      for (var i = 0; !fullTextUrl && i < ids.length; i++) {\n        var result = data[ids[i]];\n        for (var j = 0; j < result.items.length; j++) {\n          var item = result.items[j];\n          if (item.usRightsString.toLowerCase() === \"full view\") {\n            fullTextUrl = result.records[item.fromRecord].recordURL;\n            break;\n          }\n        }\n      }\n      deferred.resolve(fullTextUrl);\n    };\n\n    if (ids.length) {\n      var hathiTrustLookupUrl = hathiTrustBaseUrl + ids.join('|');\n      $http.jsonp(hathiTrustLookupUrl, { cache: true, jsonpCallbackParam: 'callback' }).then(handleResponse).catch(function (e) {\n        console.log(e);\n      });\n    } else {\n      deferred.resolve(null);\n    }\n\n    return deferred.promise;\n  };\n\n  return svc;\n}]).controller('hathiTrustAvailabilityController', ['hathiTrust', 'hathiTrustIconPath', function (hathiTrust, hathiTrustIconPath) {\n  var self = this;\n  self.hathiTrustIconPath = hathiTrustIconPath;\n\n  self.$onInit = function () {\n    setDefaults();\n    if (!(isOnline() && self.hideOnline)) {\n      updateHathiTrustAvailability();\n    }\n  };\n\n  var setDefaults = function setDefaults() {\n    if (!self.msg) self.msg = 'Full Text Available at HathiTrust';\n  };\n\n  var isOnline = function isOnline() {\n    return self.prmSearchResultAvailabilityLine.result.delivery.GetIt1.some(function (g) {\n      return g.links.some(function (l) {\n        return l.isLinktoOnline;\n      });\n    });\n  };\n\n  var updateHathiTrustAvailability = function updateHathiTrustAvailability() {\n    var hathiTrustIds = (self.prmSearchResultAvailabilityLine.result.pnx.addata.oclcid || []).map(function (id) {\n      return \"oclc:\" + id;\n    });\n    hathiTrust.findFullViewRecord(hathiTrustIds).then(function (res) {\n      self.fullTextLink = res;\n    });\n  };\n}]).component('hathiTrustAvailability', {\n  require: {\n    prmSearchResultAvailabilityLine: '^prmSearchResultAvailabilityLine'\n  },\n  bindings: {\n    hideOnline: '<',\n    msg: '@?'\n  },\n  controller: 'hathiTrustAvailabilityController',\n  template: '<span ng-if=\"$ctrl.fullTextLink\" class=\"umnHathiTrustLink\">\\\n                <md-icon md-svg-src=\"{{$ctrl.hathiTrustIconPath}}\" alt=\"HathiTrust Logo\"></md-icon>\\\n                <a target=\"_blank\" ng-href=\"{{$ctrl.fullTextLink}}\">\\\n                {{ ::$ctrl.msg }}\\\n                  <prm-icon external-link=\"\" icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"open-in-new\"></prm-icon>\\\n                </a>\\\n              </span>'\n});\n"],"sourceRoot":"/source/"}