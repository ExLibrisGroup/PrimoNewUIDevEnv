{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/HSLV/js/main.js","primo-explore/custom/HSLV/node_modules/primo-explore-getit-to-link-resolver/src/index.js","primo-explore/custom/HSLV/node_modules/primo-explore-getit-to-link-resolver/src/js/controllers/getitToLinkResolverBriefController.js","primo-explore/custom/HSLV/node_modules/primo-explore-getit-to-link-resolver/src/js/controllers/getitToLinkResolverFullController.js","primo-explore/custom/HSLV/node_modules/primo-explore-getit-to-link-resolver/src/js/getit-to-link-resolver.module.js","primo-explore/custom/HSLV/node_modules/primo-explore-getit-to-link-resolver/src/js/services/getitToLinkResolverService.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","app","angular","constant","config","$sceDelegateProvider","nodeserver","urlWhitelist","resourceUrlWhitelist","push","serviceSectionHeader","linkField","linkText","iconBefore","set","icon","iconAfter","component","template","controller","vm","this","getSearchTerm","parentCtrl","term","bindings","$scope","$http","book_icon","result","pnx","addata","doi","display","type","articleURL","jsonp","jsonpCallbackParam","then","response","article","data","error","console","log","issn","replace","journalURL","journal","newThumbnail","item","browzineEnabled","coverImageUrl","$doCheck","changes","selectedThumbnailLink","linkURL","query","facetService","$location","$$search","split","angularLoad","showTabsAndScopes","prmActionCtrl","$onInit","actionExists","smsAction","addAction","$onDestroy","removeAction","factory","addActionIcon","actionListService","requiredActionsList","splice","index","name","actionsToIndex","onToggle","actionsToDisplay","unshift","removeActionIcon","indexOf","actionLabelNamesMap","label","actionIconNamesMap","actionIcons","hasOwnProperty","finishedSmsEvent","$watch","sendEmailService","carriers","smsCarriers","carrier","phoneNumber","telRegEx","validate","test","isCaptcha","window","appConfig","getCaptchaPublicKey","setResponse","gCaptchaResponse","sendSms","sendEmail","catch","finally","run","put","value","iconSet","ATT","T-Mobile","Virgin","Sprint","Nextel","Verizon","Cricket","Qwest","Project Fi","hathiTrustBaseUrl","$q","svc","findFullViewRecord","ids","deferred","defer","hathiTrustLookupUrl","join","cache","resp","fullTextUrl","j","items","usRightsString","toLowerCase","records","fromRecord","recordURL","resolve","promise","hathiTrust","hathiTrustIconPath","self","setDefaults","isOnline","hideOnline","updateHathiTrustAvailability","msg","prmSearchResultAvailabilityLine","delivery","GetIt1","some","g","links","l","isLinktoOnline","hathiTrustIds","oclcid","map","id","res","fullTextLink","getitToLinkResolverService","ctrl","getitLink","prmBriefResultContainer","link","translate","original","shouldAddGetItLink","prmFullViewServiceContainer","service","title","filter","_getitToLinkResolverService2","default","_getitToLinkResolverFullController2","_getitToLinkResolverBriefController2","getitToLinkResolverConfig","$filter","match","p1"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import 'primo-explore-getit-to-link-resolver';\n\nvar app = app || angular.module(\n  'viewCustom', ['angularLoad', 'hathiTrustAvailability', 'sendSms', 'getitToLinkResolver']\n).constant(\n  'nodeserver', \"https://apiconnector.thirdiron.com/v1/libraries/72\"\n).config([\n  '$sceDelegateProvider',\n  'nodeserver',\n  function ($sceDelegateProvider, nodeserver) {\n    var urlWhitelist = $sceDelegateProvider.resourceUrlWhitelist();\n    urlWhitelist.push(nodeserver + '**');\n    $sceDelegateProvider.resourceUrlWhitelist(urlWhitelist);\n  }\n]);\n\napp.constant('getitToLinkResolverConfig', {\n  serviceSectionHeader: 'View It',\n  linkField: 'openURL',\n  linkText: 'Check Availability',\n  iconBefore: {\n    set: 'primo-ui',\n    icon: 'book-open'\n  },\n  iconAfter: {\n    set: 'primo-ui',\n    icon: 'open-in-new'\n  }\n});\n\napp.component('prmFullViewServiceContainerAfter', {\n  template: '<getit-to-link-resolver-full></getit-to-link-resolver-full>'\n});\n\n// Enhance No Results tile\n\napp.controller('prmNoSearchResultAfterController', [function () {\n  var vm = this;\n  vm.getSearchTerm = getSearchTerm;\n  function getSearchTerm() {\n    return vm.parentCtrl.term;\n  }\n}]);\n\napp.component('prmNoSearchResultAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmNoSearchResultAfterController',\n  template: '<md-card class=\"default-card zero-margin _md md-primoExplore-theme\"><md-card-title><md-card-title-text><span translate=\"\" class=\"md-headline ng-scope\">No records found.</span></md-card-title-text></md-card-title><md-card-content><p><span>There are no results matching your search: <i>{{$ctrl.getSearchTerm()}}</i>. Looking for a book? Try again searching items held at other libraries:</span></p><md-button class=\"md-raised md-button md-primoExplore-theme md-ink-ripple\" href=\"http://www.worldcat.org/search?q={{$ctrl.getSearchTerm()}}\" type=\"button\" aria-label=\"Search WorldCat\" style=\"margin-left:0;margin-right:0;\"> <img src=\"custom/NULV3/img/worldcat-logo.png\" width=\"22\" height=\"22\" alt=\"worldcat-logo\" style=\"vertical-align:middle;\"> Search WorldCat</md-button><p><span>Looking for an article? Try <strong><a href=\"http://scholar.google.com/scholar?hl=en&q={{$ctrl.getSearchTerm()}}\">Google Scholar</a></strong></span>.</p><p><span translate=\"\" class=\"bold-text ng-scope\">Suggestions:</span></p><ul><li translate=\"\" class=\"ng-scope\">Make sure that all words are spelled correctly.</li><li translate=\"\" class=\"ng-scope\">Try a different search scope.</li><li translate=\"\" class=\"ng-scope\">Try different search terms.</li><li translate=\"\" class=\"ng-scope\">Try more general search terms.</li><li translate=\"\" class=\"ng-scope\">Try fewer search terms.</li></ul><p><strong><a href=\"http://www.library.northwestern.edu/research/ask-us/index.html\">Contact a Research Librarian for Assistance</a></strong>.</p></md-card-content></md-card>'\n});\n\n//Add Interlibrary Loan links to My Account\n\napp.component('prmLoansOverviewAfter', {\n  bindings: {},\n  template: '<div class=\"tiles-grid-tile\"><div class=\"tile-content layout-column\" layout=\"column\"><div class=\"tile-header layout-column\" layout=\"column\"><div class=\"layout-align-space-between-stretch layout-row\" layout-align=\"space-between\"><h2 class=\"header-link light-text\"><span>Interlibrary Loan</span></h2></div></div><md-button class=\"button-with-icon overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view interlibrary loans checked out\" style=\"\" href=\"https://northwestern.illiad.oclc.org/illiad/illiad.dll?Action=10&Form=66\"><span>View Items Checked Out</span></md-button><md-button class=\"button-with-icon overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view interlibrary loans checked out\" style=\"\" href=\"https://northwestern.illiad.oclc.org/illiad/illiad.dll?Action=10&Form=64\"><span>View Items Available</span></md-button><md-button class=\"button-with-icon  overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view interlibrary loans checked out\" style=\"\" href=\"https://northwestern.illiad.oclc.org/illiad/illiad.dll?Action=10&Form=62\"><span>View Requests in Process</span></md-button></div></div>'\n});\n\n//End add ILL links\n\n// Check for content in Browzine\n\napp.controller('prmSearchResultAvailabilityLineAfterController', function ($scope, $http, nodeserver) {\n  var vm = this;\n  $scope.book_icon = \"https://s3.amazonaws.com/thirdiron-assets/images/integrations/browzine_open_book_icon.png\";\n  if (vm.parentCtrl.result.pnx.addata.doi && vm.parentCtrl.result.pnx.display.type[0] == 'article') {\n    vm.doi = vm.parentCtrl.result.pnx.addata.doi[0] || '';\n    var articleURL = nodeserver + \"/articles?DOI=\" + vm.doi;\n    $http.jsonp(articleURL, { jsonpCallbackParam: 'callback' }).then(function (response) {\n      $scope.article = response.data;\n    }, function (error) {\n      console.log(error);\n    });\n  }\n  if (vm.parentCtrl.result.pnx.addata.issn && vm.parentCtrl.result.pnx.display.type[0] == 'journal') {\n    vm.issn = vm.parentCtrl.result.pnx.addata.issn[0].replace(\"-\", \"\") || '';\n    var journalURL = nodeserver + \"/journals?ISSN=\" + vm.issn;\n    $http.jsonp(journalURL, { jsonpCallbackParam: 'callback' }).then(function (response) {\n      $scope.journal = response.data;\n    }, function (error) {\n      console.log(error);\n    });\n  }\n});\n\n//Add Browzine and Hathitrust links to Brief Results\n\napp.component('prmSearchResultAvailabilityLineAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmSearchResultAvailabilityLineAfterController',\n  template: '<div ng-if=\"article.data.browzineWebLink\"><a href=\"{{ article.data.browzineWebLink }}\" target=\"_blank\" title=\"Via BrowZine\"><img src=\"https://s3.amazonaws.com/thirdiron-assets/images/integrations/browzine_open_book_icon.png\" class=\"browzine-icon\"> View Issue Contents <md-icon md-svg-icon=\"primo-ui:open-in-new\" aria-label=\"icon-open-in-new\" role=\"img\" class=\"browzine-external-link\"><svg id=\"open-in-new_cache29\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"504\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"></svg></md-icon></a></div><div ng-if=\"journal.data[0].browzineWebLink\"><a href=\"{{ journal.data[0].browzineWebLink }}\" target=\"_blank\" title=\"Via BrowZine\"><img src=\"https://s3.amazonaws.com/thirdiron-assets/images/integrations/browzine_open_book_icon.png\" class=\"browzine-icon\"> View Journal Contents <md-icon md-svg-icon=\"primo-ui:open-in-new\" aria-label=\"icon-open-in-new\" role=\"img\" class=\"browzine-external-link\"><svg id=\"open-in-new_cache29\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"504\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"></svg></md-icon></a></div><hathi-trust-availability hide-online=\"true\"></hathi-trust-availability>'\n});\n\n// Add Journal Cover Images from BrowZine\n\napp.controller('prmSearchResultThumbnailContainerAfterController', function ($scope, $http, nodeserver) {\n  var vm = this;\n  var newThumbnail = '';\n  // checking for item property as this seems to impact virtual shelf browse (for reasons as yet unknown)\n  if (vm.parentCtrl.item && vm.parentCtrl.item.pnx.addata.issn) {\n    vm.issn = vm.parentCtrl.item.pnx.addata.issn[0].replace(\"-\", \"\") || '';\n    var journalURL = nodeserver + \"/journals?ISSN=\" + vm.issn;\n    $http.jsonp(journalURL, { jsonpCallbackParam: 'callback' }).then(function (response) {\n      if (response.data.data[\"0\"] && response.data.data[\"0\"].browzineEnabled) {\n        newThumbnail = response.data.data[\"0\"].coverImageUrl;\n      }\n    }, function (error) {\n      console.log(error); //\n    });\n  }\n  vm.$doCheck = function (changes) {\n    if (vm.parentCtrl.selectedThumbnailLink) {\n      if (newThumbnail != '') {\n        vm.parentCtrl.selectedThumbnailLink.linkURL = newThumbnail;\n      }\n    }\n  };\n});\n\napp.component('prmSearchResultThumbnailContainerAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmSearchResultThumbnailContainerAfterController'\n});\n\n// End BrowZine - Primo Integration\n\n//Logo with link\n\n/*\napp.controller('prmLogoAfterController', [function () {\n  var ctrl = this;\n\n  ctrl.getIconLink = function () {\n    return ctrl.parentCtrl.iconLink;\n  };\n}]);\n\napp.component('prmLogoAfter', {\n  bindings: {\n    parentCtrl: '<'\n  },\n  controller: 'prmLogoAfterController',\n  template: ' \\n    <div class=\"product-logo product-logo-local\" layout=\"row\" layout-align=\"start center\" layout-fill id=\"banner\" tabindex=\"0\" role=\"banner\"><a href=\"http://www.library.northwestern.edu/\"><img ng-src=\"{{$ctrl.getIconLink()}}\" alt=\"{{(\\'nui.header.LogoAlt\\' | translate)}}\"/></a>\\n    </div>\\n  '\n});\n*/\n\n//End add logo with link\n\n\n//Add NUPrint link to account\n\napp.component('prmMessagesAndBlocksOverviewAfter', {\n  bindings: { parentCtrl: '<' },\n  template: '<div class=\"tiles-grid-tile\"><div class=\"tile-content layout-column\" layout=\"column\"><div class=\"tile-header layout-column\" layout=\"column\"><div class=\"layout-align-space-between-stretch layout-row\" layout=\"row\" layout-align=\"space-between\"><h2 class=\"header-link light-text\"><span>NUPrint</span></h2></div></div><md-button class=\"button-with-icon overflow-visible md-button md-primoExplore-theme md-ink-ripple layout-align-center-center layout-row\" type=\"button\" layout=\"row\" layout-align=\"center center\" aria-label=\"view nuprint account\" style=\"\" href=\"https://nuprint.northwestern.edu/\"><span>View Account</span></md-button></div></div>'\n});\n\n//End Add NUPrint\n//Other search options\n\napp.controller('prmFacetRangeAfterController', [function () {\n  try {\n    this.query = this.parentCtrl.facetService.$location.$$search.query.split(\",\")[2];\n  } catch (e) {\n    this.query = \"\";\n  }\n}]);\n\napp.component('prmFacetRangeAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmFacetRangeAfterController',\n  template: '<md-card class=\"default-card zero-margin _md md-primoExplore-theme\"><md-card-content><p><strong>Not finding the book you were looking for?</strong> Try searching items held at other libraries:</p><md-button class=\"md-raised md-button md-primoExplore-theme md-ink-ripple\" href=\"http://www.worldcat.org/search?q={{$ctrl.query}}\" type=\"button\" aria-label=\"Search WorldCat\" style=\"margin-left:0;margin-right:0;\"> <img src=\"custom/NULV3/img/worldcat-logo.png\" width=\"22\" height=\"22\" alt=\"worldcat-logo\" style=\"vertical-align:middle;\"> Search WorldCat</md-button><p><span>Looking for an article? Try <strong><a href=\"http://scholar.google.com/scholar?hl=en&q={{$ctrl.query}}\">Google Scholar</a></strong></span>.</p>Looking for related concepts? Try <strong><a href=\"http://turing.library.northwestern.edu/login?url=https://yewno.com/edu/?query={{$ctrl.query}}\"\">Yewno</a></strong>.<p></p><p>Other questions? <strong><a href=\"http://www.library.northwestern.edu/research/ask-us/index.html\">Contact a Research Librarian for Assistance</a></strong>.</p></md-card-content></md-card>'\n});\n\n//Always display scope dropdown for basic searches\n\napp.component('prmSearchBarAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'SearchBarAfterController'\n});\n\napp.controller('SearchBarAfterController', ['angularLoad', function (angularLoad) {\n  var vm = this;\n  vm.parentCtrl.showTabsAndScopes = true;\n}]);\n\n//End display scopes\n\n//Add SMS actions menu\n\n'use strict';\n\nangular.module(\"sendSms\", [\"ngMaterial\", \"primo-explore.components\"]), angular.module(\"sendSms\").component(\"addSmsAction\", {\n  require: { prmActionCtrl: \"^prmActionList\" },\n  controller: [\"customActions\", \"smsOptions\", function (e, n) {\n    var t = this;\n    this.$onInit = function () {\n      e.actionExists(n.smsAction, t.prmActionCtrl) || e.addAction(n.smsAction, t.prmActionCtrl);\n    }, this.$onDestroy = function () {\n      e.actionExists(n.smsAction, t.prmActionCtrl) && e.removeAction(n.smsAction, t.prmActionCtrl);\n    };\n  }]\n}), angular.module(\"sendSms\").factory(\"customActions\", function () {\n  return {\n    addAction: function addAction(e, n) {\n      this.actionExists(e, n) ? console.error(\"Action already exists: \", e) : (this.addActionIcon(e, n), n.actionListService.requiredActionsList.splice(e.index, 0, e.name), n.actionListService.actionsToIndex[e.name] = e.index, n.actionListService.onToggle[e.name] = e.onToggle, n.actionListService.actionsToDisplay.unshift(e.name));\n    },\n    removeAction: function removeAction(e, n) {\n      if (this.actionExists(e, n)) {\n        this.removeActionIcon(e, n), delete n.actionListService.actionsToIndex[e.name], delete n.actionListService.onToggle[e.name];\n        var t = n.actionListService.actionsToDisplay.indexOf(e.name);\n        n.actionListService.actionsToDisplay.splice(t, 1), t = n.actionListService.requiredActionsList.indexOf(e.name), n.actionListService.requiredActionsList.splice(t, 1);\n      } else console.error(\"Action does not exist: \", e);\n    },\n    addActionIcon: function addActionIcon(e, n) {\n      n.actionLabelNamesMap[e.name] = e.label, n.actionIconNamesMap[e.name] = e.name, n.actionIcons[e.name] = e.icon;\n    },\n    removeActionIcon: function removeActionIcon(e, n) {\n      delete n.actionLabelNamesMap[e.name], delete n.actionIconNamesMap[e.name], delete n.actionIcons[e.name];\n    },\n    actionExists: function actionExists(e, n) {\n      return n.actionListService.actionsToIndex.hasOwnProperty(e.name);\n    }\n  };\n}), angular.module(\"sendSms\").component(\"ocaSendSms\", {\n  bindings: { item: \"<\", finishedSmsEvent: \"&\" },\n  template: '<div class=\"send-actions-content-item\" layout=\"row\"><md-content layout-wrap layout-padding layout-fill><form name=\"smsForm\" novalidate layout=\"column\" layout-align=\"center center\" (submit)=\"$ctrl.sendSms($event);\"><div layout=\"row\" class=\"layout-full-width\" layout-align=\"center center\"><div flex=\"20\" flex-sm=\"10\" hide-xs></div><div class=\"form-focus service-form\" layout-padding flex><div layout-margin><div layout=\"column\"><h4 class=\"md-subhead\">Standard message and data rates may apply.</h4><md-input-container class=\"underlined-input md-required\"><label>Phone number:</label><input ng-model=\"$ctrl.phoneNumber\" name=\"phoneNumber\" type=\"text\" required ng-pattern=\"::$ctrl.telRegEx\"><div ng-messages=\"smsForm.phoneNumber.$error\"><div ng-message=\"pattern, required \">phone number is invalid</div></div></md-input-container><md-input-container class=\"md-required\"><label>Carrier:</label><md-select ng-model=\"$ctrl.carrier\" name=\"carrier\" placeholder=\"Select a carrier\" required><md-option ng-repeat=\"(carrier, address) in carriers\" value=\"{{ address }}\">{{ carrier }}</md-option></md-select><div ng-messages=\"smsForm.carrier.$error\"><div ng-message=\"required\">please select a carrier</div></div></md-input-container><md-input-container class=\"underlined-input\" ng-if=\"$ctrl.isCaptcha\"><div vc-recaptcha key=\"$ctrl.getCaptchaPublicKey()\"on-success=\"$ctrl.setResponse(response)\"></div><span class=\"recaptcha-error-info\" ng-show=\"smsForm.$submitted && (smsForm.recaptchaResponse.$invalid || smsForm.$error.recaptcha.length)\"><span translate=\"captcha.notselected\"></span></span></md-input-container></div></div></div><div flex=\"20\" flex-sm=\"10\" hide-xs></div>\\n</div>\\n<div layout=\"row\"><div layout=\"row\" layout-align=\"center\" layout-fill><md-button type=\"submit\" class=\"button-with-icon button-large button-confirm\" aria-label=\"Send the result by SMS\"><prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"send\"></prm-icon><span translate=\"email.popup.link.send\"></span></md-button></div></div></form></md-content></div><prm-send-email ng-hide=\"true\"></prm-send-email><oca-send-sms-after parent-ctrl=\"$ctrl\"></oca-send-sms-after>',\n  controller: [\"$scope\", \"smsOptions\", function (e, n) {\n    var t = this;\n    this.$onInit = function () {\n      e.$watch(\"$$childTail.$ctrl\", function (e) {\n        return t.sendEmailService = e.sendEmailService;\n      }), e.carriers = n.smsCarriers, t.carrier = t.phoneNumber = \"\", t.telRegEx = /^\\d{3}( |-)?\\d{3}( |-)?\\d{4}$/;\n    }, this.validate = function () {\n      return t.telRegEx.test(t.phoneNumber) && t.carrier;\n    }, this.isCaptcha = function () {\n      return \"Y\" == window.appConfig[\"system-configuration\"][\"Activate Captcha [Y/N]\"];\n    }, this.getCaptchaPublicKey = function () {\n      return window.appConfig[\"system-configuration\"][\"Public Captcha Key\"];\n    }, this.setResponse = function (e) {\n      return t.gCaptchaResponse = e;\n    }, this.sendSms = function () {\n      t.validate() && t.sendEmailService.sendEmail([t.phoneNumber + \"@\" + t.carrier], \"\", \"\", [t.item], t.gCaptchaResponse).then(function (e) {\n        return console.log(\"sms successfully sent\", e);\n      }).catch(function (e) {\n        return console.error(\"sms sending failed\", e);\n      }).finally(function () {\n        return t.finishedSmsEvent();\n      });\n    };\n  }]\n}).run([\"$templateCache\", \"smsOptions\", function (e, n) {\n  e.put(\"components/search/actions/actionContainer/action-container.html\", \"\\n  <oca-send-sms ng-if=\\\"($ctrl.actionName==='\" + n.smsAction.name + '\\')\" finished-sms-event=\"$ctrl.throwCloseTabsEvent()\" item=\"::$ctrl.item\"></oca-send-sms>\\n  <prm-send-email ng-if=\"($ctrl.actionName===\\'E-mail\\')\" (finished-email-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [toggleform]=\"::$ctrl.toggleActionCotent\" [user]=\"::\\'\\'\"></prm-send-email>\\n  <prm-citation ng-if=\"($ctrl.actionName===\\'Citation\\')\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-citation>\\n  <prm-permalink ng-if=\"($ctrl.actionName===\\'Permalink\\')\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-permalink>\\n  <prm-print-item ng-if=\"($ctrl.actionName===\\'Print\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-print-item>\\n  <prm-endnote ng-if=\"($ctrl.actionName===\\'EndNote\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-endnote>\\n  <prm-easybib ng-if=\"($ctrl.actionName===\\'EasyBib\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-easybib>\\n  <prm-refworks ng-if=\"($ctrl.actionName===\\'RefWorks\\')\" (close-tabs-event)=\"$ctrl.throwCloseTabsEvent()\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-refworks>\\n  <prm-export-ris ng-if=\"($ctrl.actionName===\\'RISPushTo\\')\" [item]=\"::$ctrl.item\" [on-toggle]=\"::$ctrl.onToggle\"></prm-export-ris>\\n  <prm-action-container-after parent-ctrl=\"$ctrl\"></prm-action-container-after>');\n}]), angular.module(\"sendSms\").value(\"smsOptions\", { smsAction: { name: \"send_sms\", label: \"SMS\", index: 9, icon: { icon: \"ic_smartphone_24px\", iconSet: \"hardware\", type: \"svg\" } }, smsCarriers: { ATT: \"txt.att.net\", \"T-Mobile\": \"tmomail.net\", Virgin: \"vmobl.com\", Sprint: \"messaging.sprintpcs.com\", Nextel: \"messaging.nextel.com\", Verizon: \"vtext.com\", Cricket: \"mms.mycricket.com\", Qwest: \"qwestmp.com\", \"Project Fi\": \"msg.fi.google.com\" } });\n\napp.component('prmActionListAfter', {\n  template: '<add-sms-action />'\n});\n\n//end SMS \n\n//Adds link to Yewno after each set of ten results\n\napp.controller('prmSearchResultListAfterController', [function () {\n  try {\n    this.query = this.parentCtrl.facetService.$location.$$search.query.split(\",\")[2];\n  } catch (e) {\n    this.query = \"\";\n  }\n}]);\n\napp.component('prmSearchResultListAfter', {\n  bindings: { parentCtrl: '<' },\n  controller: 'prmSearchResultListAfterController',\n  template: '<div class=\"layout-sm-column layout=\"column\"><div class=\"layout-row\" layout=\"row\"><div class=\"layout-row flex\" layout=\"row\"><md-card class=\"one-slot _md md-primoExplore-theme flex yewno-recommender\"><md-card-content class=\"layout-row\" layout=\"row\"><div class=\"max-width-100\"><div class=\"layout-row\"><div class=\"resource-image\"><div class=\"resource-image-inner normlized-resource-image\"><img class=\"md-card-image\" src=\"custom/NULV3/img/yewno-logo.png\"></div></div><div class=\"resource-content layout-fill\"><h3 class=\"normal-text resource-title\"><a href=\"http://turing.library.northwestern.edu/login?url=https://yewno.com/edu/?query={{$ctrl.query}}\">Try Yewno Discover</a></h3><p>Yewno is a new research platform that displays search results as relationships between concepts.</p><p>Search Yewno when you want to explore a topic and see what the connections are.</p><div></div></div></div></md-card-content></md-card></div></div></div>'\n});\n\n//End add link to Yewno\n//HathiTrust availability link\n\nangular.module('hathiTrustAvailability', []).value('hathiTrustIconPath', 'custom/NULV3/img/hathitrust.svg').constant('hathiTrustBaseUrl', \"https://catalog.hathitrust.org/api/volumes/brief/json/\").config(['$sceDelegateProvider', 'hathiTrustBaseUrl', function ($sceDelegateProvider, hathiTrustBaseUrl) {\n  var urlWhitelist = $sceDelegateProvider.resourceUrlWhitelist();\n  urlWhitelist.push(hathiTrustBaseUrl + '**');\n  $sceDelegateProvider.resourceUrlWhitelist(urlWhitelist);\n}]).factory('hathiTrust', ['$http', '$q', function ($http, $q) {\n  var svc = {};\n  var hathiTrustBaseUrl = \"https://catalog.hathitrust.org/api/volumes/brief/json/\";\n\n  svc.findFullViewRecord = function (ids) {\n    var deferred = $q.defer();\n\n    var handleResponse = function handleResponse(resp) {\n      var data = resp.data;\n      var fullTextUrl = null;\n      for (var i = 0; !fullTextUrl && i < ids.length; i++) {\n        var result = data[ids[i]];\n        for (var j = 0; j < result.items.length; j++) {\n          var item = result.items[j];\n          if (item.usRightsString.toLowerCase() === \"full view\") {\n            fullTextUrl = result.records[item.fromRecord].recordURL;\n            break;\n          }\n        }\n      }\n      deferred.resolve(fullTextUrl);\n    };\n\n    if (ids.length) {\n      var hathiTrustLookupUrl = hathiTrustBaseUrl + ids.join('|');\n      $http.jsonp(hathiTrustLookupUrl, { cache: true, jsonpCallbackParam: 'callback' }).then(handleResponse).catch(function (e) {\n        console.log(e);\n      });\n    } else {\n      deferred.resolve(null);\n    }\n\n    return deferred.promise;\n  };\n\n  return svc;\n}]).controller('hathiTrustAvailabilityController', ['hathiTrust', 'hathiTrustIconPath', function (hathiTrust, hathiTrustIconPath) {\n  var self = this;\n  self.hathiTrustIconPath = hathiTrustIconPath;\n\n  self.$onInit = function () {\n    setDefaults();\n    if (!(isOnline() && self.hideOnline)) {\n      updateHathiTrustAvailability();\n    }\n  };\n\n  var setDefaults = function setDefaults() {\n    if (!self.msg) self.msg = 'Full Text Available at HathiTrust';\n  };\n\n  var isOnline = function isOnline() {\n    return self.prmSearchResultAvailabilityLine.result.delivery.GetIt1.some(function (g) {\n      return g.links.some(function (l) {\n        return l.isLinktoOnline;\n      });\n    });\n  };\n\n  var updateHathiTrustAvailability = function updateHathiTrustAvailability() {\n    var hathiTrustIds = (self.prmSearchResultAvailabilityLine.result.pnx.addata.oclcid || []).map(function (id) {\n      return \"oclc:\" + id;\n    });\n    hathiTrust.findFullViewRecord(hathiTrustIds).then(function (res) {\n      self.fullTextLink = res;\n    });\n  };\n}]).component('hathiTrustAvailability', {\n  require: {\n    prmSearchResultAvailabilityLine: '^prmSearchResultAvailabilityLine'\n  },\n  bindings: {\n    hideOnline: '<',\n    msg: '@?'\n  },\n  controller: 'hathiTrustAvailabilityController',\n  template: '<span ng-if=\"$ctrl.fullTextLink\" class=\"umnHathiTrustLink\">\\\n                <md-icon md-svg-src=\"{{$ctrl.hathiTrustIconPath}}\" alt=\"HathiTrust Logo\"></md-icon>\\\n                <a target=\"_blank\" ng-href=\"{{$ctrl.fullTextLink}}\">\\\n                {{ ::$ctrl.msg }}\\\n                  <prm-icon external-link=\"\" icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"open-in-new\"></prm-icon>\\\n                </a>\\\n              </span>'\n});\n","require('./js/getit-to-link-resolver.module.js')\nmodule.exports = 'getitToLinkResolver'\n","export default function(getitToLinkResolverService, $scope) {\n  const ctrl = this;\n  ctrl.$onInit = function() {\n    // Get our config in this scope\n    $scope.config = getitToLinkResolverService.config;\n    $scope.getitLink = (() => {\n      try {\n        return ctrl.prmBriefResultContainer.item.link[$scope.config.linkField];\n      } catch (e) {\n        return '#';\n      }\n    })() || '#';\n  };\n  // Retrieve the GetIt link from whichever field the config told us it's in\n  // note the different path for looking for links in full and brief displays\n  // Yes this needs to be DRYed up\n  // Use the translate function in this scope\n  $scope.translate = (original) => getitToLinkResolverService.translate(original);\n}\n","export default function(getitToLinkResolverService, $scope) {\n  const ctrl = this;\n  ctrl.$onInit = function() {\n    // Get our config in this scope\n    $scope.config = getitToLinkResolverService.config;\n    // Are we in the \"send to\" section? Then we're going to add our GetIt\n    // link right after it as a new section\n    $scope.shouldAddGetItLink = ctrl.prmFullViewServiceContainer.service.title === \"nui.brief.results.tabs.send_to\";\n\n    $scope.getitLink = (() => {\n      try {\n        return ctrl.prmFullViewServiceContainer.item.delivery.link.filter(link =>\n          link[\"displayLabel\"] === getitToLinkResolverService.config.linkField\n        )[0][\"linkURL\"];\n      } catch (e) {\n        return '#';\n      }\n    })() || '#';\n  };\n  // Retrieve the GetIt link from whichever field the config told us it's in\n  // note the different path for looking for links in full and brief displays\n  // Use the translate function in this scope\n  $scope.translate = (original) => getitToLinkResolverService.translate(original);\n}\n","// html templates\nimport getitToLinkResolverFull from '../html/getitToLinkResolverFull.html';\nimport getitToLinkResolverBrief from '../html/getitToLinkResolverBrief.html';\n\n// controllers\nimport getitToLinkResolverFullController from './controllers/getitToLinkResolverFullController.js';\nimport getitToLinkResolverBriefController from './controllers/getitToLinkResolverBriefController.js';\n\nimport getitToLinkResolverService from './services/getitToLinkResolverService.js';\n\nangular\n  // Define the module name\n  .module('getitToLinkResolver', [])\n  // A reusable object for this module with our translate function\n  // and a convenience 'config' object\n  .factory('getitToLinkResolverService', ['getitToLinkResolverConfig', '$filter', getitToLinkResolverService])\n  // Controller for below full-display component\n  .controller('getitToLinkResolverFullController', ['getitToLinkResolverService', '$scope', getitToLinkResolverFullController])\n  // Controller for below brief-display component\n  .controller('getitToLinkResolverBriefController', ['getitToLinkResolverService', '$scope', getitToLinkResolverBriefController])\n  // Component to add to the full display page\n  .component('getitToLinkResolverFull', {\n    // Include the full view service container controller\n    // it's where the getit link will be found\n    require: {\n      prmFullViewServiceContainer: '^prmFullViewServiceContainer'\n    },\n    // Use the above controller\n    controller: 'getitToLinkResolverFullController',\n    // Setup a new section copying the markup from previous sections\n    template: getitToLinkResolverFull\n  })\n  // Component to add to the brief display page\n  .component('getitToLinkResolverBrief', {\n    // Include the brief result container controller\n    // it's where the getit link will be found for the brief result\n    require: {\n      prmBriefResultContainer: '^prmBriefResultContainer'\n    },\n    // Use the above controller\n    controller: 'getitToLinkResolverBriefController',\n    // Setup a new link to include after the brief result copying existing markup\n    // classes like \"md-button neutralized-button\" allow it to function like a\n    // button, i.e. not display strangely and be clickable\n    template: getitToLinkResolverBrief\n  });\n","export default function(getitToLinkResolverConfig, $filter) {\n  return {\n    // Use the translate filter to get values from the Primo Back Office\n    translate: function(original) {\n      return original.replace(/\\{(.+)\\}/g, (match, p1) => $filter('translate')(p1));\n    },\n    // Set reusable config constants from the config element on the parent ng app\n    config: {\n      linkField: getitToLinkResolverConfig.linkField,\n      linkText: getitToLinkResolverConfig.linkText,\n      iconBefore: getitToLinkResolverConfig.iconBefore,\n      iconAfter: getitToLinkResolverConfig.iconAfter,\n      serviceSectionHeader: getitToLinkResolverConfig.serviceSectionHeader\n    }\n  };\n}\n"],"sourceRoot":"/source/"}